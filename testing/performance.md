# 性能测试

## 性能测试的目的：发现性能瓶颈

### 性能测试的分类

#### 概念

- 性能测试是一个非常广泛的概念，包括很多方面的测试，也可称之为非功能测试。
- 自动化测试属于功能测试的范围，由于其测试方法要求测试人员拥有一定的代码能力，所以被单独分成一个测试模块。


#### 具体分类（测试范围）

- 负载测试：通过逐步加压的方法，达到既定的性能阈值的目标，阈值的设定应是小于等于某个值，如cpu使用率小于等于80%。
- 压力测试：通过逐步加压的方法，使得系统的某些资源达到饱和，甚至失效的状态，简单粗暴的解释就是什么条件能把系统压奔溃。
- 并发测试：在同一时间内，多个虚拟用户同时访问同一个模块、同一功能，通常的测试方法是设置集合点。
- 容量测试：通常是指数据库层面的，目标是获取数据库的最佳容量的能力。有称之为容量预估。具体测试方法在一定的并发用户，不同的基础数据量下，观察数据库的处理能力，即获取数据库的各项性能指标。
- 可靠性测试： 又称之为稳定性测试或疲劳测试。是指系统在高压情况下，长时间的运行系统是否稳定。如cpu使用率80%以上，7*24小时运行，系统是否稳定。
- 异常测试：又称之为失败测试。是指系统架构方面的测试。如在负载均衡架构中，要测试宕机、节点挂掉等情况系统等反应

#### 工作流程

需求分析 -> 性能指标制定 -> 脚本开发 -> 场景设置 -> 监控部署 -> 执行测试 -> 性能分析 -> 性能调优 -> 测试报告

#### 常见系统应用分层架构

- 显示层（view）：Web、Android、iOS、H5
- 逻辑控制层（controller）：Api
- 数据存储层（model）：MySQL、MongoDB、Redis

#### 性能指标的定义

##### 事务
- 从客户端发起的一个或多个请求（这些请求组成一个完整的操作），到客户端接收到服务器返回到响应

##### TPS（Transaction Per Second）
- 每秒钟系统能处理的事务数

##### 请求响应时间
- 从客户端发起的一个请求开始，到客户端接收到服务器返回到响应。整个过程所耗费的时间。

##### 事务响应时间
- 事务可能是由一个或多个请求组成的，事务响应时间主要是针对于用户的角度而言，如转账。

##### 定发定义
- 没有严格意义的并发。并发总有先后，无论差距是1毫秒或者是1微秒，总有一个时间差。所以并发讲的是一个时间范围内，比如1秒内。

##### 并发举例
- 多个用户在系统上进行同一操作，比如双十一时，大家都针对一种商品进行秒杀
- 多用户在系统上进行不同操作，比如双十一时，大家针对不同商品进行秒杀，或者是大家进行其他不同的操作，比如商品浏览。

##### 并发用户数
- 同一单位时间内 对系统发起请求的用户数量

##### 吞吐量
- 一次性能测试过程中网络上传输的数据量的总和

##### 吞吐率
- 单位时间内网络上传输的数据量
- 吞吐率=吞吐量/传输时间

##### 点击率
每秒钟用户向服务器提交的请求数。这个指标时web应用程序特有的一个指标，可以想像为每秒钟用户总共在页面上进行多少次点击动作，但是需要注意的是一次鼠标单击的操作后，客户端有可能想服务器发送了多次请求。

##### 资源使用率
- 对不同的系统资源的使用情况，如cpu、内存、io